#!/usr/bin/env bash

for VW_FILE in $(find vowpalwabbit -type f -name '*.cc' -o -name '*.h'); do
    
    if [ "$1" = check ]; then
       diff $VW_FILE <(clang-format $VW_FILE);
       if [ $? -ne 0 ]; then
       	  echo "Run \"./utl/clang-format fix\""
	  exit 1
       fi
    fi
    
    if [ "$1" = fix ]; then
       clang-format -i $VW_FILE;
    fi
    
done
